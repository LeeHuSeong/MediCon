<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>진단서</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="DiagnosisStyle.css">
</head>
<body>

<div class="actions">
  <button onclick="window.print()" >인쇄하기</button>
  <button id="download">PDF 저장</button>
</div>
<div class="certificate-box" id="certificate">
  <div class="title">진 &nbsp; 단 &nbsp; 서</div>

  <div class="issue-date">차트번호: ${chartNumber}</div>
  <table>
    <tr>
      <th rowspan="3">진료환자</th>
      <th>성명</th>
      <td colspan="2">${name}</td>
      <th>주민번호</th>
      <td colspan="2">${rrn}</td>
    </tr>
    <tr>
      <th>성별</th>
      <td colspan="2">${gender}</td>
      <th>전화번호</th>
      <td colspan="2">${phoneNum}</td>
    </tr>
    <tr>
      <th>주소</th>
      <td colspan="5">${address}</td>
    </tr>
    <tr>
      <th rowspan="2">진료병원</th>
      <th>병원명</th>
      <td colspan="2">${hospitalName}</td>
      <th>연락처</th>
      <td colspan="2">${hospitalPhoneNum}</td>
    </tr>
    <tr>
      <th>진료과</th>
      <td colspan="5">${department}</td>
    </tr>
    <tr>
      <th>담당의사</th>
      <td colspan="2">${doctorName}</td>
      <th>면허번호</th>
      <td colspan="3">${licenseNumber}</td>
    </tr>
    <tr>
      <th>병명</th>
      <td colspan="6">${diagnosis}</td>
    </tr>
    <tr>
      <th>발병일</th>
      <td colspan="2">${startSickDay}</td>
      <th>입원기간</th>
      <td colspan="3">${hospitalizationPeriod}</td>
    </tr>
    <tr>
      <th>통원기간</th>
      <td colspan="3">${outpatientPeriod}</td>
      <th>퇴원일</th>
      <td colspan="2">${dischargeDate}</td>
    </tr>
    <tr>
      <th style="height: 100px;" colspan="2">진료경과 및 소견</th>
      <td class="align-top-left" colspan="5">${doctorOpinion}</td>
    </tr>
    <tr>
      <th>비고</th>
      <td colspan="3">${notes}</td>
      <th>진단 목적</th>
      <td colspan="2">${properties}</td>
    </tr>
  </table>

  <div class="footer">
    상기 환자에 대해 위와 같이 진단하였음을 증명합니다
  </div>
  <br/>
  <div class="issue-date">진단일: ${diagnosisDate}</div>
  <div class="issue-date">발행일: ${issueDate}</div>

  <div class="hospital-info">
    발급의사 성명: &nbsp; ${doctorName} &nbsp; (서명 또는 인)<br/><br/>
    원장: 황원장 (인)
  </div>

  <div class="bottom-center">◯◯종합병원</div>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
<script>
  document.getElementById("download").addEventListener("click", () => {
    const element = document.getElementById("certificate");
    html2pdf().set({
      margin: 0.5,
      filename: '진단서.pdf',
      image: { type: 'jpeg', quality: 0.98 },
      html2canvas: { scale: 2 },
      jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
    }).from(element).save();
  });
</script>
</body>
</html>
